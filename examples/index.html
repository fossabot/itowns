<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Itowns Examples</title>

    <link type="text/css" rel="stylesheet" href="../docs/static/styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="../docs/static/styles/itowns.css">
</head>

<body data-spy="scroll" data-target="nav" onload="onLoad()">

<div id="main">
    <iframe id="content" class="scroll-section" frameborder="0" height="100%"></iframe>
</div>

<nav class="scroll-section">
    <img id="goToHome" src="../docs/static/images/itowns_logo.png" width="230px" onclick="goTo('home.html', 'home')"/>
</nav>

<script type="text/javascript">
    var baseURI = document.baseURI;

    function bindIframe() {
        var navLinks = document.getElementsByClassName('nav-link');
        for (var i = 0; i < navLinks.length; i++) {
            navLinks[i].addEventListener('click', function(e) {
                e.preventDefault();
                var target = e.target.localName === 'b' ? e.target.parentNode : e.target;
                var url = target.href.replace('#', '') + '.html';
                var slug = target.hash;
                goTo(url, slug);
            });
        }

        // load page if setted
        if (document.location.hash) {
            var url = document.location.href.replace('#', '') + '.html';
            goTo(url);
        } else {
            //goTo('home.html', 'home');
        }
    };

    function goTo(url, slug) {
        if (slug) window.location.hash = slug;
        var iframe = document.getElementById('content');
        iframe.src = url;
    };

    function initNavigation(list) {
        var nav = '';

        for (var section in list) {
            nav += '<div class="package">';
            nav += `<h3 class="nav-section">${section}</h3>`;
            nav += '<ul>';

            for (var example in list[section]) {
                nav += '<li class="nav-item">';
                nav += `<a class="nav-link" href="#${list[section][example]}">`;
                nav += `${example}</a></li>`;
            }

            nav += '</ul></div>';
        }

        document.getElementsByTagName('nav')[0].insertAdjacentHTML('beforeend', nav);
    }

    function onLoad() {
        // Get the configuration
        fetch('./config.json').then(function _(response) {
            return response.json();
        }).then(function _(config) {
            initNavigation(config);
            bindIframe();
        });
    }
</script>
</body>
</html>
